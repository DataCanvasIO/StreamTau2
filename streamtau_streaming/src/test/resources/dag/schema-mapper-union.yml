parallelism: 1
operators:
  TheSource:
    fid: prelude.local-file-source
    name: LocalFileSource
    path: 'classpath:/data/name-gender-scores.txt'
  TheParser:
    fid: prelude.schema-parser
    name: SchemaParser
    description: Parsing event according schema.
    dependencies:
      - TheSource
    schemaId: A
    format: application/yaml
  TheMapperMaths:
    fid: prelude.schema-mapper
    name: ScheamMapper
    dependencies:
      - TheParser
    schemaId: B
    mappings:
      - target: name
        value: name
      - target: gender
        value: gender
      - target: selectedSubject
        value: '"Maths"'
      - target: selectedScore
        value: scores.maths
  TheMapperEnglish:
    fid: prelude.schema-mapper
    name: ScheamMapper
    dependencies:
      - TheParser
    schemaId: B
    mappings:
      - target: name
        value: name
      - target: gender
        value: gender
      - target: selectedSubject
        value: '"English"'
      - target: selectedScore
        value: scores.english
  TheSink:
    fid: test.collect-sink
    name: CollectSink
    description: Sink to collect the result.
    dependencies:
      - TheMapperMaths
      - TheMapperEnglish
schemas:
  A:
    type: object
    additionalProperties: false
    properties:
      name:
        type: string
      gender:
        type: string
      scores:
        type: object
        additionalProperties: false
        properties:
          maths:
            type: integer
          english:
            type: integer
  B:
    type: object
    additionalProperties: false
    properties:
      name:
        type: string
      gender:
        type: string
      selectedSubject:
        type: string
      selectedScore:
        type: integer
